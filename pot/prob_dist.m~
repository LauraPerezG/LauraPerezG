function [x_alpha, mrho, sigma2_rho]=prob_dist(x,P)

%PROB_DIST(x, T, P) defines the probability distribution for a set of x
%positions and P number of bins
%INPUTS
%x:positions
%P: number of bins
%OUTPUTS
%x_alpha: central position of the bins
%mrho: probability distribution
%sigma2_rho: standard deviation of 



%obtain number of experiments
[~,Nexp]=size(x);
%defines the bins edges
edges=linspace(min(x(:)),max(x(:)),P);

%defines the lenght of bins
dx=edges(2)-edges(1);

%defines central position of the bins
x_alpha=(edges(2:end)+edges(1:end-1))/2;

%define the histogram
for j=1:Nexp
    
    xx=x(:,j);

    [frequency(:,j)]=histcounts(xx,edges);
    
end

% after normalization it becomes the probability density
frequency=frequency./(sum(frequency,1)*dx);

%mean probability distribution
mrho=mean(frequency,2);

%standard deviation squared of probability distribution
sigma2_rho=std(frequency,[],2);

end